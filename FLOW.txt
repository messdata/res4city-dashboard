START
  |
  V
ğŸ“‚ Read 'Output.xlsx'
  |
  V
ğŸ“Š Filter: Hours_to_Complete < 90
  |
  V
ğŸ” For each user in filtered list:
  |
  â”œâ”€â”€ ğŸ§‘ Get: user_id, email, course_code, hours_to_complete
  |
  â”œâ”€â”€ ğŸ”— Create redirect tracking URL:
  |       http://127.0.0.1:5050/redirect?user_id={email}&dest=https://www.res4city.eu/
  |
  â”œâ”€â”€ ğŸ“¨ Generate Email:
  |     â”œâ”€â”€ get_html_template(...) â†’ HTML version
  |     â””â”€â”€ get_plain_text_template(...) â†’ plain text
  |
  â”œâ”€â”€ ğŸ“ Attach logo (if provided)
  |
  â”œâ”€â”€ ğŸ“¤ Send email via SMTP (Gmail App Password)
  |
  â””â”€â”€ ğŸ“ Log success/failure to results list
  |
  V
ğŸ“„ Save results to 'Sent_log.xlsx'
  |
  V
ğŸƒ Launch CTR click tracking server (Flask app on port 5050)
  |
  V
ğŸ”„ CTR logs all clicks to 'click_log.txt' with timestamps
  |
  V
â Optionally export click stats to Excel
  |
  V
âœ… END
